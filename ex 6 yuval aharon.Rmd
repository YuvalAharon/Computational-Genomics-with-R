---
title: "Exercise 6"
author: "yuval aharon"
date: "12 12 2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
expFile=system.file("extdata",
                    "leukemiaExpressionSubset.rds",
                    package="compGenomRData")

mat=readRDS(expFile)
```

```{r}
boxplot(mat)

scaledMat = scale(mat)
boxplot(scaledMat)

logMat = log2(mat)
boxplot(logMat)

scaledLogMat = scale(logMat)
boxplot(scaledLogMat)

```

```{r}
library(pheatmap)

# set the leukemia type annotation for each sample
annotation_col = data.frame(
                    LeukemiaType =substr(colnames(mat),1,3))
rownames(annotation_col)=colnames(mat)


pheatmap(mat,show_rownames=FALSE,show_colnames=FALSE,
         annotation_col=annotation_col,
         scale = "none",
         clustering_method="ward.D",
         main = "mat without scaling")

pheatmap(scaledMat,show_rownames=FALSE,show_colnames=FALSE,
         annotation_col=annotation_col,
         scale = "none",
         clustering_method="ward.D",
         main = "mat with scaling")

pheatmap(logMat,show_rownames=FALSE,show_colnames=FALSE,
         annotation_col=annotation_col,
         scale = "none",
         clustering_method="ward.D",
         main = "log scaled mat")

pheatmap(scaledLogMat,show_rownames=FALSE,show_colnames=FALSE,
         annotation_col=annotation_col,
         scale = "none",
         clustering_method="ward.D",
         main = "mat with scaling and log")

```

3.
```{r}
library(cluster)
#for transformed data.
set.seed(101)
pamclu=cluster::pam(t(scaledLogMat),k=5)
plot(silhouette(pamclu),main=NULL)

# for untransformed data.
set.seed(101)
pamclu=cluster::pam(t(mat),k=5)
plot(silhouette(pamclu),main=NULL)

```

```{r}
# for transformed data.
Ks=sapply(2:7,
    function(i) 
      summary(silhouette(pam(t(scaledLogMat),k=i)))$avg.width)
plot(2:7,Ks,xlab="k",ylab="av. silhouette",type="b",
     pch=19)

# for untransformed data.
Ks=sapply(2:7,
    function(i) 
      summary(silhouette(pam(t(mat),k=i)))$avg.width)
plot(2:7,Ks,xlab="k",ylab="av. silhouette",type="b",
     pch=19)
```


